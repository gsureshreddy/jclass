/*!
 * JavaScript Inheritance with Private Members
 * Largely based upon John Resig's inheritance technique,
 * (see http://ejohn.org/blog/simple-javascript-inheritance/)
 * that was inspired by base2 and Prototype.
 *
 * Works with and without node.
 *
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 *
 * Marcel Rieger, 2013
 * https://github.com/riga/jclass
 * https://npmjs.org/package/jclass
 */
var defaultOpts={extendable:true,initKey:"init",superKey:"_super",privatePattern:/^__.+/,tracking:false,privateKey:"__",methodsKey:"__jcMethods__",depthKey:"__jcDepth__",callerDepthKey:"__jcCallerDepth__"};
var initializing=false;var JClass=function(){};JClass.extend=function(f,a){a=a||{};for(var j in defaultOpts){if(a[j]===undefined){a[j]=defaultOpts[j];}}var k=this.prototype;
initializing=true;var h=new this();initializing=false;h[a.depthKey]=k[a.depthKey]||0;h[a.depthKey]++;var e=h[a.depthKey];var c={};var d={};var l={};for(var b in f){if(f[b] instanceof Function){var g=(function(m,n){return function(){if(this[a.callerDepthKey]===undefined){this[a.callerDepthKey]=e;
}var o=this[a.superKey];if(!a.privatePattern.test(m)){this[a.superKey]=k[m];}var w;if(a.privateKey){w=this[a.privateKey];this[a.privateKey]=w||l;}var r=this[a.methodsKey];
if(m==a.initKey){this[a.methodsKey]=r||c;for(var s in c){this[a.methodsKey][s]=this[a.methodsKey][s]||{};this[a.methodsKey][s][e]=c[s][e];var v=this[a.methodsKey][s][e];
this[a.methodsKey][s][e]=function(){var E=this[a.superKey];this[a.superKey]=this[a.methodsKey][s][e-1];var D=v.apply(this,arguments);this[a.superKey]=E;
return D;};}c=this[a.methodsKey];}else{this[a.methodsKey]=c;}var x={};for(var s in this[a.methodsKey]){x[s]=this[s];var z=Math.max.apply(Math,Object.keys(c[s]));
this[s]=c[s][z];}var q;if(a.tracking){var q={};for(var A in d){q[A]=this[A];this[A]=d[A];}}var B;if(a.tracking){var B=Object.keys(this);}var u=n.apply(this,arguments);
if(a.tracking){var y=Object.keys(this);for(var A in y){A=y[A];var C=B.indexOf(A)<0&&a.privatePattern.test(A);if(C){q[A]=this[A];d[A]=this[A];}}for(var A in B){A=B[A];
var t=y.indexOf(A)<0&&a.privatePattern.test(A);if(t){delete d[A];delete this[A];}}for(var A in d){var p=this[a.callerDepthKey];if(q[A]===undefined||e==p){delete this[A];
}else{this[A]=q[A];}}}for(var A in this[a.methodsKey]){if(x[A]===undefined){delete this[A];}else{this[A]=x[A];}}if(r===undefined){delete this[a.methodsKey];
}else{this[a.methodsKey]=r;}if(a.privateKey){if(w===undefined){delete this[a.privateKey];}else{this[a.privateKey]=w;}}if(o===undefined){delete this[a.superKey];
}else{this[a.superKey]=o;}if(e==this[a.callerDepthKey]){delete this[a.callerDepthKey];}return u;};})(b,f[b]);if(a.privatePattern.test(b)){c[b]={};c[b][e]=g;
}else{h[b]=g;}}else{if(a.privatePattern.test(b)&&a.tracking){d[b]=f[b];}else{h[b]=f[b];}}}function i(){if(!initializing&&this[a.initKey]){this[a.initKey].apply(this,arguments);
}}i.prototype=h;i.prototype.constructor=i;if(a.extendable!==false){i.extend=arguments.callee;}return i;};if(typeof module!=="undefined"&&module.exports){module.exports=JClass;
}